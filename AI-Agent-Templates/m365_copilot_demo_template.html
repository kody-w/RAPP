<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>M365 Copilot</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", -apple-system, BlinkMacSystemFont, system-ui,
          sans-serif;
        background: #faf9f8;
        height: 100vh;
        display: flex;
        overflow: hidden;
        color: #323130;
      }

      /* Sidebar */
      .sidebar {
        width: 260px;
        background: #ffffff;
        display: flex;
        flex-direction: column;
        border-right: 1px solid #edebe9;
      }

      /* Sidebar Header */
      .sidebar-header {
        padding: 12px 16px;
        display: flex;
        align-items: center;
        gap: 10px;
        border-bottom: 1px solid #edebe9;
        height: 48px;
      }

      .copilot-icon {
        width: 24px;
        height: 24px;
        background: linear-gradient(
          135deg,
          #b4a0ff 0%,
          #ff7eb9 50%,
          #7ee7fc 100%
        );
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }

      .copilot-icon::before {
        content: "";
        position: absolute;
        width: 12px;
        height: 12px;
        background: white;
        border-radius: 2px;
        opacity: 0.9;
      }

      .sidebar-title {
        font-size: 14px;
        font-weight: 600;
        color: #323130;
      }

      .sidebar-button {
        margin-left: auto;
        background: none;
        border: none;
        padding: 4px;
        cursor: pointer;
        color: #605e5c;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        width: 32px;
        height: 32px;
      }

      .sidebar-button:hover {
        background: #f3f2f1;
      }

      /* Search Box */
      .search-container {
        padding: 8px 16px;
        border-bottom: 1px solid #edebe9;
      }

      .search-box {
        position: relative;
        width: 100%;
      }

      .search-icon {
        position: absolute;
        left: 8px;
        top: 50%;
        transform: translateY(-50%);
        color: #605e5c;
        font-size: 14px;
      }

      .search-input {
        width: 100%;
        padding: 6px 8px 6px 32px;
        border: 1px solid #d2d0ce;
        border-radius: 4px;
        font-size: 14px;
        background: #faf9f8;
        outline: none;
        transition: all 0.2s;
      }

      .search-input:focus {
        border-color: #605e5c;
        background: #ffffff;
      }

      /* Navigation */
      .nav-section {
        flex: 1;
        overflow-y: auto;
        padding: 4px 0;
      }

      .nav-item {
        padding: 8px 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        cursor: pointer;
        font-size: 14px;
        color: #323130;
        transition: background 0.1s;
        position: relative;
        user-select: none;
      }

      .nav-item:hover {
        background: #f3f2f1;
      }

      .nav-item.active {
        background: #f3f2f1;
      }

      .nav-item.active::before {
        content: "";
        position: absolute;
        left: 0;
        top: 8px;
        bottom: 8px;
        width: 2px;
        background: #5b5fc7;
        border-radius: 1px;
      }

      .nav-icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .nav-icon-circle {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: #e74856;
      }

      .nav-icon-bot {
        width: 16px;
        height: 16px;
        border-radius: 4px;
        background: #0078d4;
        position: relative;
      }

      .nav-icon-bot::before {
        content: "";
        position: absolute;
        top: 3px;
        left: 3px;
        right: 3px;
        height: 4px;
        background: white;
        border-radius: 1px;
      }

      .nav-icon-bot::after {
        content: "";
        position: absolute;
        bottom: 3px;
        left: 3px;
        right: 3px;
        height: 4px;
        background: white;
        border-radius: 1px;
      }

      .nav-expand {
        margin-left: auto;
        color: #605e5c;
        font-size: 10px;
        transition: transform 0.2s;
      }

      .nav-expand.expanded {
        transform: rotate(180deg);
      }

      /* Dropdown */
      .nav-dropdown {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.2s ease;
      }

      .nav-dropdown.expanded {
        max-height: 400px;
      }

      .dropdown-item {
        padding: 6px 16px 6px 48px;
        font-size: 14px;
        color: #605e5c;
        cursor: pointer;
        transition: background 0.1s;
      }

      .dropdown-item:hover {
        background: #f3f2f1;
        color: #323130;
      }

      /* Bottom section */
      .sidebar-bottom {
        border-top: 1px solid #edebe9;
        padding: 8px 0;
      }

      .user-section {
        padding: 8px 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        cursor: pointer;
        transition: background 0.1s;
      }

      .user-section:hover {
        background: #f3f2f1;
      }

      .user-avatar {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #5b5fc7;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: 600;
      }

      .user-name {
        font-size: 14px;
        color: #323130;
      }

      .user-menu {
        margin-left: auto;
        color: #605e5c;
      }

      /* Main Content */
      .main-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        background: #faf9f8;
      }

      /* Header */
      .content-header {
        height: 48px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: #ffffff;
        border-bottom: 1px solid #edebe9;
      }

      .header-title {
        font-size: 14px;
        color: #605e5c;
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .gpt-selector {
        padding: 6px 12px;
        border: 1px solid #d2d0ce;
        border-radius: 4px;
        background: white;
        font-size: 14px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        color: #323130;
        transition: all 0.2s;
      }

      .gpt-selector:hover {
        border-color: #605e5c;
      }

      .header-icon-button {
        width: 32px;
        height: 32px;
        border: none;
        background: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        color: #605e5c;
        transition: background 0.1s;
      }

      .header-icon-button:hover {
        background: #f3f2f1;
      }

      /* Chat Container */
      .chat-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      /* Welcome Screen */
      .welcome-screen {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 40px;
        max-width: 1200px;
        margin: 0 auto;
        width: 100%;
      }

      .welcome-title {
        font-size: 36px;
        font-weight: 600;
        color: #323130;
        margin-bottom: 48px;
        text-align: center;
      }

      /* Suggestion Cards */
      .suggestion-cards {
        display: flex;
        gap: 20px;
        width: 100%;
        max-width: 900px;
        margin-bottom: 40px;
      }

      .suggestion-card {
        flex: 1;
        background: white;
        border: 1px solid #edebe9;
        border-radius: 8px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.2s;
        min-height: 140px;
      }

      .suggestion-card:hover {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }

      .card-icon {
        font-size: 24px;
        margin-bottom: 12px;
      }

      .card-icon.edit {
        color: #e74856;
      }

      .card-icon.write {
        color: #ff8c00;
      }

      .card-icon.file {
        color: #0078d4;
      }

      .card-title {
        font-size: 14px;
        font-weight: 600;
        color: #323130;
        margin-bottom: 8px;
      }

      .card-description {
        font-size: 13px;
        color: #605e5c;
        line-height: 1.4;
      }

      /* See More */
      .see-more {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #5b5fc7;
        font-size: 14px;
        cursor: pointer;
        background: none;
        border: none;
        padding: 8px 12px;
        border-radius: 4px;
        transition: background 0.1s;
      }

      .see-more:hover {
        background: #f3f2f1;
      }

      /* Chat Messages */
      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        display: none;
      }

      .chat-messages.active {
        display: block;
      }

      .message {
        max-width: 900px;
        margin: 0 auto 24px;
      }

      .message-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 8px;
      }

      .message-avatar-user {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #5b5fc7;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: 600;
      }

      .message-avatar-agent {
        width: 28px;
        height: 28px;
        border-radius: 6px;
        background: #0078d4;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: 600;
      }

      .message-author {
        font-size: 14px;
        font-weight: 600;
        color: #323130;
      }

      .message-tag {
        padding: 2px 8px;
        background: #f3f2f1;
        border-radius: 4px;
        font-size: 12px;
        color: #605e5c;
      }

      .message-time {
        font-size: 12px;
        color: #a19f9d;
      }

      .message-content {
        margin-left: 40px;
        font-size: 14px;
        line-height: 1.6;
        color: #323130;
      }

      /* Agent Cards */
      .agent-card {
        margin-left: 40px;
        margin-top: 16px;
        background: white;
        border: 1px solid #edebe9;
        border-radius: 8px;
        overflow: hidden;
      }

      .agent-card-header {
        padding: 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        border-bottom: 1px solid #edebe9;
      }

      .agent-card-icon {
        font-size: 20px;
      }

      .agent-card-title {
        font-size: 16px;
        font-weight: 600;
        color: #323130;
      }

      .agent-card-content {
        padding: 16px;
      }

      .detail-list {
        list-style: none;
      }

      .detail-item {
        padding: 4px 0;
        font-size: 14px;
        color: #323130;
        display: flex;
        gap: 8px;
      }

      .detail-label {
        font-weight: 600;
        min-width: 140px;
      }

      .detail-value {
        color: #605e5c;
      }

      /* Data Table */
      .data-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
      }

      .data-table th {
        background: #faf9f8;
        padding: 12px 16px;
        text-align: left;
        font-weight: 600;
        color: #323130;
        border-bottom: 1px solid #edebe9;
      }

      .data-table td {
        padding: 12px 16px;
        color: #605e5c;
        border-bottom: 1px solid #edebe9;
      }

      .data-table tr:hover td {
        background: #faf9f8;
      }

      /* Input Container */
      .input-container {
        padding: 16px 20px;
        background: white;
        border-top: 1px solid #edebe9;
      }

      .input-wrapper {
        max-width: 900px;
        margin: 0 auto;
        position: relative;
      }

      .input-field {
        width: 100%;
        padding: 12px 48px 12px 16px;
        border: 1px solid #d2d0ce;
        border-radius: 8px;
        font-size: 14px;
        font-family: inherit;
        resize: none;
        outline: none;
        background: #faf9f8;
        transition: all 0.2s;
        min-height: 44px;
        max-height: 120px;
      }

      .input-field:focus {
        border-color: #605e5c;
        background: white;
      }

      .input-actions {
        position: absolute;
        right: 8px;
        bottom: 8px;
        display: flex;
        gap: 4px;
      }

      .input-button {
        width: 28px;
        height: 28px;
        border: none;
        background: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        color: #605e5c;
        transition: all 0.1s;
      }

      .input-button:hover {
        background: #f3f2f1;
      }

      .input-button.send {
        color: #5b5fc7;
      }

      .input-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* AI Badge */
      .ai-note {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 8px 12px;
        background: white;
        border: 1px solid #edebe9;
        border-radius: 4px;
        font-size: 12px;
        color: #605e5c;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      /* Help Button */
      .help-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: #0078d4;
        color: white;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        transition: all 0.2s;
        font-size: 20px;
      }

      .help-button:hover {
        background: #106ebe;
        transform: scale(1.05);
      }

      /* Loading */
      .typing-indicator {
        margin-left: 40px;
        display: flex;
        gap: 4px;
        padding: 8px 0;
      }

      .typing-dot {
        width: 8px;
        height: 8px;
        background: #605e5c;
        border-radius: 50%;
        animation: typing 1.4s infinite;
      }

      .typing-dot:nth-child(2) {
        animation-delay: 0.2s;
      }

      .typing-dot:nth-child(3) {
        animation-delay: 0.4s;
      }

      @keyframes typing {
        0%,
        60%,
        100% {
          transform: translateY(0);
          opacity: 0.5;
        }
        30% {
          transform: translateY(-10px);
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="copilot-icon"></div>
        <span class="sidebar-title">M365 Copilot</span>
        <button class="sidebar-button">‚ò∞</button>
      </div>

      <div class="search-container">
        <div class="search-box">
          <span class="search-icon">üîç</span>
          <input type="text" class="search-input" placeholder="Search" />
        </div>
      </div>

      <div class="nav-section">
        <div class="nav-item active" onclick="showChat()">
          <div class="nav-icon">
            <div class="nav-icon-circle"></div>
          </div>
          <span>Chat</span>
        </div>

        <div class="nav-item" onclick="toggleDropdown('agents')">
          <div class="nav-icon">
            <div class="nav-icon-bot"></div>
          </div>
          <span>Agents</span>
          <span class="nav-expand" id="agents-expand">‚ñº</span>
        </div>
        <div class="nav-dropdown" id="agents-dropdown">
          <div class="dropdown-item">Agent</div>
          <div class="dropdown-item">Explore agents</div>
          <div class="dropdown-item">Create agent</div>
        </div>

        <div class="nav-item" onclick="toggleDropdown('conversations')">
          <div class="nav-icon">üí¨</div>
          <span>Conversations</span>
          <span class="nav-expand" id="conversations-expand">‚ñº</span>
        </div>
        <div class="nav-dropdown" id="conversations-dropdown">
          <div class="dropdown-item">
            I need floor estimates. Do this one: https://phot...
          </div>
          <div class="dropdown-item">What do you remember?</div>
          <div class="dropdown-item">hello</div>
          <div class="dropdown-item">hello</div>
          <div class="dropdown-item">Hello! what can you do?</div>
          <div class="dropdown-item">All conversations</div>
        </div>

        <div class="nav-item">
          <div class="nav-icon">üìÑ</div>
          <span>Pages</span>
          <span class="nav-expand">‚ñº</span>
        </div>

        <div class="nav-item">
          <div class="nav-icon">‚ûï</div>
          <span>Create</span>
        </div>

        <div class="nav-item">
          <div class="nav-icon">üì±</div>
          <span>Apps</span>
        </div>

        <div class="nav-item">
          <div class="nav-icon">‚öôÔ∏è</div>
          <span>Admin</span>
        </div>
      </div>

      <div class="sidebar-bottom">
        <div class="user-section">
          <div class="user-avatar">KA</div>
          <span class="user-name">Kody Administrator</span>
          <span class="user-menu">‚ãØ</span>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <div class="content-header">
        <div class="header-title" id="headerTitle">Chat</div>
        <div class="header-actions">
          <button class="gpt-selector">
            Try GPT-5
            <span>‚ñº</span>
          </button>
          <button class="header-icon-button">üìé</button>
          <button class="header-icon-button">üîÑ</button>
          <button class="header-icon-button">‚ãØ</button>
        </div>
      </div>

      <div class="chat-container">
        <!-- Welcome Screen -->
        <div class="welcome-screen" id="welcomeScreen">
          <h1 class="welcome-title">Welcome Kody, how can I help?</h1>

          <div class="suggestion-cards">
            <div
              class="suggestion-card"
              onclick="sendMessage('Rewrite this to sound more professional and less verbose: [your text]')"
            >
              <div class="card-icon edit">‚úèÔ∏è</div>
              <div class="card-title">
                Rewrite this to sound more professional and less verbose:
              </div>
              <div class="card-description">Improve your writing</div>
            </div>

            <div
              class="suggestion-card"
              onclick="sendMessage('Analyze this text and make suggestions on how to improve the clarity')"
            >
              <div class="card-icon write">‚úèÔ∏è</div>
              <div class="card-title">
                Analyze this text and make suggestions on how to improve...
              </div>
              <div class="card-description">Sharpen your writing</div>
            </div>

            <div
              class="suggestion-card"
              onclick="sendMessage('Summarize file')"
            >
              <div class="card-icon file">üìÑ</div>
              <div class="card-title">Summarize file</div>
              <div class="card-description">Get an overview</div>
            </div>
          </div>

          <button class="see-more">
            See more
            <span>‚ñº</span>
          </button>
        </div>

        <!-- Chat Messages -->
        <div class="chat-messages" id="chatMessages">
          <!-- Messages will be dynamically added here -->
        </div>

        <!-- Input Container -->
        <div class="input-container">
          <div class="input-wrapper">
            <textarea
              class="input-field"
              id="messageInput"
              placeholder="Message Copilot"
              rows="1"
              onkeypress="handleKeyPress(event)"
              oninput="autoResize(this)"
            ></textarea>
            <div class="input-actions">
              <button class="input-button">‚ûï</button>
              <button class="input-button">üé§</button>
              <button
                class="input-button send"
                onclick="sendCurrentMessage()"
                id="sendButton"
              >
                ‚û§
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Help Button -->
    <button class="help-button" onclick="showHelp()">?</button>

    <script>
      // State
      let currentView = "chat";
      let isProcessing = false;
      let messageHistory = [];

      // Initialize
      document.addEventListener("DOMContentLoaded", function () {
        console.log("M365 Copilot initialized");
      });

      // Toggle dropdown
      function toggleDropdown(name) {
        const dropdown = document.getElementById(name + "-dropdown");
        const expand = document.getElementById(name + "-expand");
        dropdown.classList.toggle("expanded");
        if (expand) {
          expand.classList.toggle("expanded");
        }
      }

      // Show chat
      function showChat() {
        document.getElementById("welcomeScreen").style.display = "none";
        document.getElementById("chatMessages").classList.add("active");
      }

      // Auto resize textarea
      function autoResize(textarea) {
        textarea.style.height = "auto";
        textarea.style.height = Math.min(textarea.scrollHeight, 120) + "px";
      }

      // Handle key press
      function handleKeyPress(event) {
        if (event.key === "Enter" && !event.shiftKey) {
          event.preventDefault();
          sendCurrentMessage();
        }
      }

      // Send current message
      function sendCurrentMessage() {
        const input = document.getElementById("messageInput");
        const message = input.value.trim();
        if (message && !isProcessing) {
          sendMessage(message);
          input.value = "";
          autoResize(input);
        }
      }

      // Send message
      function sendMessage(message) {
        if (isProcessing) return;

        // Hide welcome screen
        if (document.getElementById("welcomeScreen").style.display !== "none") {
          showChat();
        }

        // Add user message
        addUserMessage(message);

        // Process message
        processMessage(message);
      }

      // Add user message
      function addUserMessage(message) {
        const chatMessages = document.getElementById("chatMessages");
        const messageDiv = document.createElement("div");
        messageDiv.className = "message";

        const time = new Date().toLocaleString("en-US", {
          month: "long",
          day: "numeric",
          hour: "numeric",
          minute: "2-digit",
        });

        messageDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-avatar-user">KA</div>
                    <span class="message-author">You</span>
                    <span class="message-time">${time}</span>
                </div>
                <div class="message-content">${escapeHtml(message)}</div>
            `;

        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;

        messageHistory.push({ type: "user", content: message });
      }

      // Process message
      async function processMessage(message) {
        isProcessing = true;
        document.getElementById("sendButton").disabled = true;

        // Show typing indicator
        showTypingIndicator();

        // Simulate processing
        setTimeout(() => {
          removeTypingIndicator();

          // Generate response
          const response = generateResponse(message);
          addAgentMessage(response);

          isProcessing = false;
          document.getElementById("sendButton").disabled = false;
        }, 1500);
      }

      // Generate response
      function generateResponse(message) {
        const lower = message.toLowerCase();

        if (lower.includes("floor") || lower.includes("estimate")) {
          return {
            text: "Here's your full flooring estimate for the linked space:",
            card: {
              type: "room-analysis",
              title: "üè† Room Analysis",
              data: {
                roomType: "Master Bathroom",
                confidence: "High",
                shape: "Irregular",
                features:
                  "Toilet alcove, bathtub, shower enclosure, double vanity, large arched window, recessed lighting",
              },
            },
            table: {
              title: "üìè Measurements & Coverage",
              headers: ["Dimension", "Value"],
              rows: [
                ["Length", "14.0 ft"],
                ["Width", "18.0 ft"],
                ["Total Base Area", "221.76 sq ft"],
              ],
            },
          };
        }

        return {
          text: `I understand you'd like help with: "${message}". I can assist with various tasks including document analysis, data processing, scheduling, and more. What specific aspect would you like me to focus on?`,
        };
      }

      // Add agent message
      function addAgentMessage(response) {
        const chatMessages = document.getElementById("chatMessages");
        const messageDiv = document.createElement("div");
        messageDiv.className = "message";

        const time = new Date().toLocaleString("en-US", {
          month: "long",
          day: "numeric",
        });

        let html = `
                <div class="message-header">
                    <div class="message-avatar-agent">C</div>
                    <span class="message-author">Agent</span>
                    <span class="message-tag">‚ìò</span>
                    <span class="message-time">${time}</span>
                </div>
                <div class="message-content">${response.text}</div>
            `;

        // Add card if present
        if (response.card) {
          html += renderCard(response.card);
        }

        // Add table if present
        if (response.table) {
          html += renderTable(response.table);
        }

        messageDiv.innerHTML = html;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;

        messageHistory.push({ type: "agent", content: response });
      }

      // Render card
      function renderCard(card) {
        if (card.type === "room-analysis") {
          return `
                    <div class="agent-card">
                        <div class="agent-card-header">
                            <span class="agent-card-icon">üè†</span>
                            <span class="agent-card-title">Room Analysis</span>
                        </div>
                        <div class="agent-card-content">
                            <ul class="detail-list">
                                <li class="detail-item">
                                    <span class="detail-label">Detected Room Type:</span>
                                    <span class="detail-value">${card.data.roomType}</span>
                                </li>
                                <li class="detail-item">
                                    <span class="detail-label">Confidence:</span>
                                    <span class="detail-value">${card.data.confidence}</span>
                                </li>
                                <li class="detail-item">
                                    <span class="detail-label">Shape:</span>
                                    <span class="detail-value">${card.data.shape}</span>
                                </li>
                                <li class="detail-item">
                                    <span class="detail-label">Detected Features:</span>
                                    <span class="detail-value">${card.data.features}</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                `;
        }
        return "";
      }

      // Render table
      function renderTable(table) {
        let html = `
                <div class="agent-card">
                    <div class="agent-card-header">
                        <span class="agent-card-icon">üìè</span>
                        <span class="agent-card-title">${table.title}</span>
                    </div>
                    <div class="agent-card-content">
                        <table class="data-table">
                            <thead>
                                <tr>
            `;

        table.headers.forEach((header) => {
          html += `<th>${header}</th>`;
        });

        html += `
                                </tr>
                            </thead>
                            <tbody>
            `;

        table.rows.forEach((row) => {
          html += "<tr>";
          row.forEach((cell) => {
            html += `<td>${cell}</td>`;
          });
          html += "</tr>";
        });

        html += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

        return html;
      }

      // Show typing indicator
      function showTypingIndicator() {
        const chatMessages = document.getElementById("chatMessages");
        const indicator = document.createElement("div");
        indicator.id = "typingIndicator";
        indicator.className = "typing-indicator";
        indicator.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
        chatMessages.appendChild(indicator);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      // Remove typing indicator
      function removeTypingIndicator() {
        const indicator = document.getElementById("typingIndicator");
        if (indicator) {
          indicator.remove();
        }
      }

      // Show help
      function showHelp() {
        alert(
          "Need help? This is a demo of M365 Copilot. Try asking questions or clicking the suggestion cards."
        );
      }

      // Escape HTML
      function escapeHtml(text) {
        const map = {
          "&": "&amp;",
          "<": "&lt;",
          ">": "&gt;",
          '"': "&quot;",
          "'": "&#039;",
        };
        return text.replace(/[&<>"']/g, (m) => map[m]);
      }
    </script>
  </body>
</html>
